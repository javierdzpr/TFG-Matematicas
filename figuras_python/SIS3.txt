#SIS3

import numpy as np
import matplotlib.pyplot as plt

# Ajustar tamaño de la fuente
plt.rcParams.update({
    "font.size": 16,
    "axes.titlesize": 18,
    "axes.labelsize": 16,
    "xtick.labelsize": 16,
    "ytick.labelsize": 16,
    "legend.fontsize": 14
})

# Parámetros
beta = 1
alpha = 0.4

# Puntos de la malla
I_vals = np.linspace(0, 1, 20)
S_vals = 1 - I_vals

# Campo vectorial
dI = beta * S_vals * I_vals - alpha * I_vals
dS = -dI

# Diagrama de fase
plt.figure(figsize=(7,6))
plt.quiver(S_vals, I_vals, dS, dI, color=[0, 0.4470, 0.7410],
           angles='xy', scale_units='xy', scale=None, width=0.005)

# Calculamos punto de equilibrio
S_star=alpha/beta
I_star=1-alpha/beta

plt.plot(alpha/beta, 1-alpha/beta, 'ro', markersize=6, label=f'Equilibrio endémico ({S_star:.2f}, {I_star:.2f})')
plt.plot(1,0,'rx',markersize=6, label='Equilibrio libre de enfermedad (1,0)')

plt.xlabel('S',fontsize=16)
plt.ylabel('I',fontsize=16)
plt.title(f'Diagrama de fase S-I del modelo SIS, \n $\\beta={beta}$, $\\alpha={alpha}$')
plt.legend()
plt.axis([-0.05,1.05,-0.05,1.05])
plt.grid(True)
plt.savefig("SIS3.pdf", bbox_inches='tight')
plt.show()